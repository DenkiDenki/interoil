<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Noticias RSS</title>
</head>
<body>
    <h1>Ãšltimas Noticias</h1>
    <ul id="listaNoticias"></ul>

    <!-- script>
        async function obtenerRSS() {
            try {
                const response = await fetch('http://localhost:3000/api/rss');
                const data = await response.json();

                console.log(data);
                console.log(hexML.body.reports.report[0].files.file.link.$.href);
                
                const noticias = data.rss.channel.item; // Accede a las noticias
                const lista = document.getElementById('listaNoticias');

                noticias.forEach(noticia => {
                    const li = document.createElement('li');
                    li.innerHTML = `<strong>${noticia.title}</strong> - ${noticia.pubDate}`;
                    lista.appendChild(li);
                });

            } catch (error) {
                console.error('Error al obtener RSS:', error);
            }
        }

        obtenerRSS();
    </script-->

    <script>
       function xmlToJson(xml) {
    let obj = {};
    if (xml.nodeType === 1) { // Element
        if (xml.attributes.length > 0) {
            obj["@attributes"] = {};
            for (let i = 0; i < xml.attributes.length; i++) {
                let attr = xml.attributes.item(i);
                obj["@attributes"][attr.nodeName] = attr.nodeValue;
            }
        }
    } else if (xml.nodeType === 3) { // Text
        return xml.nodeValue.trim();
    }
    if (xml.hasChildNodes()) {
        for (let i = 0; i < xml.childNodes.length; i++) {
            let item = xml.childNodes.item(i);
            let nodeName = item.nodeName;
            if (typeof obj[nodeName] === "undefined") {
                obj[nodeName] = xmlToJson(item);
            } else {
                if (typeof obj[nodeName].push === "undefined") {
                    obj[nodeName] = [obj[nodeName]];
                }
                obj[nodeName].push(xmlToJson(item));
            }
        }
    }
    return obj;
}

async function obtenerYConvertirXML() {
    try {
        const response = await fetch('https://rss.globenewswire.com/Hexmlreportfeed/organization/dBwf4frPXJHvuGJ2iT_UgA==/');
        const xmlText = await response.text();
        console.log("XML obtenido:", xmlText);
        /*// Convertir texto XML en un documento XML
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(xmlText, "text/xml");

        // Convertir XML en JSON
        const json = xmlToJson(xmlDoc);
        console.log("JSON resultante:", json);*/
    } catch (error) {
        console.error('Error al obtener el XML:', error);
    }
}

obtenerYConvertirXML();
    </script>
</body>
</html>